use masterclientcoverage

--select * into dbo.masterclientcwm12210 from masterclientcwm 

select * from masterclientcwm where categorycodeid in (
72,
82,
209,
44,
68,
473,
476,
477,
478,
479,
1031,
1032,
1033,
1034,
51,
211,
30,
417,
208,
721,
468,
214,
71,
69,
218,
78,
86,
46,
76,
47,
62,
84,
36,
77,
274,
60,
67,
74,
54,
34,
48,
83,
80,
39,
98,
38,
40,
458,
558,
580,
1336,
966,
1165,
1323,
215,
216,
217,
592,
603,
846,
847,
848,
849,
850,
190,
354,
361,
75,
42,
32
) and startdate < '10/01/2007'

update masterclientcwm
set startdate ='10/01/2007'
 where  
categorycodeid in (
72,
82,
209,
44,
68,
473,
476,
477,
478,
479,
1031,
1032,
1033,
1034,
51,
211,
30,
417,
208,
721,
468,
214,
71,
69,
218,
78,
86,
46,
76,
47,
62,
84,
36,
77,
274,
60,
67,
74,
54,
34,
48,
83,
80,
39,
98,
38,
40,
458,
558,
580,
1336,
966,
1165,
1323,
215,
216,
217,
592,
603,
846,
847,
848,
849,
850,
190,
354,
361,
75,
42,
32
) 
 and startdate < '10/01/2007'




select distinct mcc.clientid,clientname,categorycodeid,cc.category ,min(startdate) 
from mt2sql00.masterclientcoverage.dbo.masterclientcwm mcc inner join mt2sql04.subscription.dbo.clientprofile c
on mcc.clientid=c.clientid inner join categorycode cc on cc.id=mcc.categorycodeid
where categorycodeid in (select [id] from categorycode where (ispdt=0 and clientpdt=0) and catonly=0 and isnull(isadlert,0)<>1 
and isnull(ismaster,0)<>1) and startdate < '10/01/2007'
and mcc.clientid not in 
(
3,12,24,45,92,162,253,146,95,98
)
group by mcc.clientid,categorycodeid,clientname,cc.category